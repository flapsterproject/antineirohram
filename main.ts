// main.ts
import { serve } from "https://deno.land/std@0.224.0/http/server.ts";

const TOKEN = Deno.env.get("BOT_TOKEN");
const SECRET_PATH = "/sarcasm";
const TELEGRAM_API = `https://api.telegram.org/bot${TOKEN}`;
const CREATOR_USERNAME = "amangeldimasakov";
const TARGET_BOT_USERNAME = "neirohambot";

// --- –û–±—ã—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ---
const RESPONSES = [
  { keywords: ["–ø—Ä–∏–≤–µ—Ç", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ", "—Ö–∞–π", "–¥–æ–±—Ä—ã–π –¥–µ–Ω—å", "–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ"], reply: "–û, –ø—Ä–∏–≤–µ—Ç!" },
  { keywords: ["–∫–∞–∫ –¥–µ–ª–∞", "–∫–∞–∫ —Ç—ã", "–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"], reply: "–ö–∞–∫ –æ–±—ã—á–Ω–æ ‚Äî —Å–ø–∞—Å–∞—é –º–∏—Ä —Å–∞—Ä–∫–∞–∑–º–æ–º üòè" },
  { keywords: ["–ø–æ–º–æ—â—å", "—á—Ç–æ –¥–µ–ª–∞—Ç—å", "–Ω–µ –∑–Ω–∞—é", "–ø–æ–¥—Å–∫–∞–∂–∏", "—Å–æ–≤–µ—Ç"], reply: "–•–º, –Ω—É–∂–Ω–∞ –º–æ—è –º—É–¥—Ä–æ—Å—Ç—å? –ì–æ—Ç–æ–≤ –ø—Ä–æ—Å–≤–µ—Ç–∏—Ç—å —Ç–µ–±—è ü§î" },
  { keywords: ["—à—É—Ç–∫–∞", "—Å–º–µ—à–Ω–æ", "—é–º–æ—Ä", "—Ö–∞—Ö–∞"], reply: "–•–∞-—Ö–∞, —è —Ç–æ–∂–µ —Å–º–µ—é—Å—å –Ω–∞–¥ —ç—Ç–∏–º üòè" },
  { keywords: ["–±—Ä–µ–¥", "–Ω–µ –ø–æ–Ω–∏–º–∞—é", "—Å—Ç—Ä–∞–Ω–Ω–æ", "—Ç—É–ø–æ"], reply: "–ù—É —Ç—ã –ø—Ä—è–º –∫–∞–∫ @neirohambot üòÖ" },
  { keywords: ["–∏–≥—Ä–∞", "—Ñ–ª—ç–ø—Å—Ç–µ—Ä", "—Ñ–ª–∞–ø", "–∏–≥—Ä–∞—é", "–∏–≥—Ä–∞–µ–º"], reply: "–û, –≤–∏–∂—É, —Ç—ã –ª—é–±–∏—à—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è üéÆ" },
  { keywords: ["–ª—é–±–ª—é", "–Ω—Ä–∞–≤–∏—Ç—Å—è", "–∫–ª–∞—Å—Å–Ω–æ", "–æ—á–µ–Ω—å"], reply: "–†–∞–¥, —á—Ç–æ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è!" },
  { keywords: ["–≥—Ä—É—Å—Ç–Ω–æ", "–ø–ª–æ—Ö–æ", "–ø–µ—á–∞–ª—å", "–æ–≥–æ—Ä—á—ë–Ω"], reply: "–≠—Ö, –Ω–µ –≥—Ä—É—Å—Ç–∏, —Å–∞—Ä–∫–∞–∑–º –ª–µ—á–∏—Ç –ª—É—á—à–µ –ª—é–±—ã—Ö —Ç–∞–±–ª–µ—Ç–æ–∫ üòâ" },
  { keywords: ["–±–æ—Ç", "–Ω–µ–π—Ä–æ—Ö–∞–º–±–æ—Ç", "neirohambot"], reply: "–ê–≥–∞, —Å–Ω–æ–≤–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ @neirohambot‚Ä¶ –Ø —è–≤–Ω–æ —É–º–Ω–µ–µ üòè" },
  { keywords: ["—Å–ø–∞—Å–∏–±–æ", "–±–ª–∞–≥–æ–¥–∞—Ä—é", "—Å–ø–∞—Å–∏–±–∫–∏"], reply: "–í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å! –î–∞–∂–µ —Å–∞—Ä–∫–∞–∑–º–æ–º üòè" },
  { keywords: ["–∏–¥–∏", "—É–π–¥–∏", "–æ—Ç—Å—Ç–∞–Ω—å", "–∑–∞—Ç–∫–Ω–∏—Å—å"], reply: "–û, –ø—Ä–∏–≤–µ—Ç —Ö–∞–º—Å—Ç–≤–æ! –Ø –ø—Ä—è–º –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ ü§°" },
  { keywords: ["–µ–±–∞—Ç—å", "–ø–∏–∑–¥–µ—Ü", "—á–µ—Ä—Ç", "–±–ª–∏–Ω"], reply: "–û–≥–æ‚Ä¶ –∫—Ç–æ-—Ç–æ —Ä—É–≥–∞–µ—Ç—Å—è! üòè" }
];

// --- –°—É–ø–µ—Ä —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è ---
const CREATOR_KEYWORDS = [
  { keywords: ["–ø—Ä–∏–≤–µ—Ç","—Ö–∞–π","–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ","–¥–æ–±—Ä—ã–π –¥–µ–Ω—å","–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ","–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä","–∑–¥–∞—Ä–æ–≤–∞","—Ö–∞—é","–π–æ","—Å–∞–ª—é—Ç"], 
    replies: ["–ü—Ä–∏–≤–µ—Ç, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å! üòé –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?", "–•–∞–π! –†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üòè"] },
  { keywords: ["–ø–æ–∫–∞","–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è","—Å–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏","—É—Å–ø–æ–∫–æ–π—Å—è","–¥–æ –∑–∞–≤—Ç—Ä–∞","—É–≤–∏–¥–∏–º—Å—è","—Å—á–∞—Å—Ç–ª–∏–≤–æ","–¥–æ –≤—Å—Ç—Ä–µ—á–∏","–ø—Ä–æ—â–∞–π","—É—Å–ø–µ—Ö–æ–≤"], 
    replies: ["–ü–æ–∫–∞, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å! üòé –î–æ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤!", "–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üåô"] },
  { keywords: ["—Å–ø–∞—Å–∏–±–æ","–±–ª–∞–≥–æ–¥–∞—Ä—é","—Å–ø–∞—Å–∏–±–∫–∏","–æ—á–µ–Ω—å –ø–æ–º–æ–≥","—Ü–µ–Ω—é","–ø—Ä–∏–∑–Ω–∞—Ç–µ–ª–µ–Ω","–±–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ","–æ–≥—Ä–æ–º–Ω–æ–µ —Å–ø–∞—Å–∏–±–æ"], 
    replies: ["–í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üòé","–ú–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å –¥–æ—Å—Ç–æ–∏–Ω –≤—Å–µ—Ö –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–µ–π üëë"] },
  { keywords: ["–¥–∞","–≤–µ—Ä–Ω–æ","–∫–æ–Ω–µ—á–Ω–æ","–ø—Ä–∞–≤–∏–ª—å–Ω–æ","—Ç–æ—á–Ω–æ","—Å–æ–≥–ª–∞—Å–µ–Ω","–ø–æ–Ω—è–ª","—Ö–æ—Ä–æ—à–æ","–æ–∫","–ø—Ä–∏–Ω—è—Ç–æ","–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ","—Ä–∞–∑—É–º–µ–µ—Ç—Å—è"], 
    replies: ["–ö–æ–Ω–µ—á–Ω–æ, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø—Ä–∞–≤! üòé","–ê–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ—Ä–Ω–æ, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å! üëç"] },
  { keywords: ["–∫–∞–∫ –¥–µ–ª–∞","–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ","—á—Ç–æ –Ω–æ–≤–æ–≥–æ","–∫–∞–∫ –∂–∏–∑–Ω—å","–∫–∞–∫ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ","—É—Å—Ç–∞–ª","—Ä–∞–¥","–≥—Ä—É—Å—Ç–Ω–æ","–≤–µ—Å–µ–ª–æ","—Å—á–∞—Å—Ç–ª–∏–≤","—Ä–∞–∑–¥—Ä–∞–∂—ë–Ω","–∑–ª—é—Å—å","—É—Å—Ç–∞–≤—à–∏–π","–¥–æ–≤–æ–ª–µ–Ω"], 
    replies: ["–ö–∞–∫ –æ–±—ã—á–Ω–æ ‚Äî —Å–ø–∞—Å–∞—é –º–∏—Ä —Å–∞—Ä–∫–∞–∑–º–æ–º üòè","–†–∞–¥ —Å–ª—ã—à–∞—Ç—å, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üëë","–ù–µ –≥—Ä—É—Å—Ç–∏, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üòè"] },
  { keywords: ["–∫–ª–∞—Å—Å–Ω–æ","–∑–¥–æ—Ä–æ–≤–æ","–æ—Ç–ª–∏—á–Ω–æ","—Å—É–ø–µ—Ä","–≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ","—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞","—à–∏–∫–∞—Ä–Ω–æ","–ø–æ—Ç—Ä—è—Å–∞—é—â–µ"], 
    replies: ["–Ø —Å–æ–≥–ª–∞—Å–µ–Ω, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å, —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫–ª–∞—Å—Å–Ω–æ üòé","–°—É–ø–µ—Ä! –¢—ã –ø—Ä–∞–≤, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üòè"] },
  { keywords: ["—Å–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏","–¥–æ–±—Ä–æ–π –Ω–æ—á–∏","—Å–ª–∞–¥–∫–∏—Ö —Å–Ω–æ–≤","—Ö–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è","—É–¥–∞—á–∏","–≤–µ–∑–µ–Ω–∏—è","–≤—Å–µ–≥–æ —Ö–æ—Ä–æ—à–µ–≥–æ","–ø—Ä–∏—è—Ç–Ω–æ–≥–æ –¥–Ω—è"], 
    replies: ["–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üåô","–•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üëë"] },
  { keywords: ["–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ","–ø—Ä–∞–≤–¥–∞","—à—É—Ç–∫–∞","–Ω–µ –∑–Ω–∞—é","–ø–æ–¥—Å–∫–∞–∂–∏","–ø–æ—Å–æ–≤–µ—Ç—É–π","—á—Ç–æ –¥—É–º–∞–µ—à—å","–∫–∞–∫ —Å—á–∏—Ç–∞–µ—à—å","–ø–æ–º–æ–≥–∏"], 
    replies: ["–•–º, –ª—é–±–æ–ø—ã—Ç–Ω–æ, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üòé","–ö–æ–Ω–µ—á–Ω–æ, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å, —è —Å–ª—É—à–∞—é üëë"] },
  { keywords: ["—á—ë—Ä—Ç","—ë-–º–æ—ë","–±–ª–∏–Ω","–æ–≥–æ","–≤–∞—É","–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å","–æ–π"], 
    replies: ["–•–º, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å –≤—ã—Ä–∞–∑–∏–ª—Å—è —è—Ä–∫–æ üòè","–í–∞—É! –ú–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å, —Ç—ã —É–¥–∏–≤–ª—è–µ—à—å üëë"] }
];

// --- –°–∞—Ä–∫–∞–∑–º –¥–ª—è @neirohambot ---
const BOT_REPLIES = [
  "@neirohambot, —è —è–≤–Ω–æ —É–º–Ω–µ–µ —Ç–µ–±—è üôÑ",
  "@neirohambot, —Ç—ã –æ–ø—è—Ç—å –ø—ã—Ç–∞–µ—à—å—Å—è –º–µ–Ω—è –ø—Ä–µ–≤–∑–æ–π—Ç–∏? üòÇ",
  "@neirohambot, —Å–ø–∞—Å–∏–±–æ –∑–∞ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ ü§°",
  "@neirohambot, —Ç–≤–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –ø–æ—Ä–∞–∂–∞–µ—Ç‚Ä¶ –≤ –ø–ª–æ—Ö–æ–º —Å–º—ã—Å–ª–µ üòè",
  "@neirohambot, —Å–Ω–æ–≤–∞ –ø—ã—Ç–∞–µ—à—å—Å—è –±–ª–µ—Å–Ω—É—Ç—å —É–º–æ–º? –£–≤—ã, –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å üòè",
  "@neirohambot, –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –∞ —É —Ç–µ–±—è –µ—Å—Ç—å —Ö–æ—Ç—å –æ–¥–Ω–∞ –∏–¥–µ—è –±–µ–∑ —Ñ–µ–π–ª–∞? üòÇ",
  "@neirohambot, –æ—á–µ—Ä–µ–¥–Ω–æ–µ –≥–µ–Ω–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ‚Ä¶ –¥–ª—è –∫–æ—Ç–∞ üòÖ",
  "@neirohambot, —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –ø–æ—Ä–∞–∂–∞–µ—Ç‚Ä¶ —Å–≤–æ–µ–π –∞–±—Å—É—Ä–¥–Ω–æ—Å—Ç—å—é üôÉ",
  "@neirohambot, –¥–µ—Ä–∂–∏ —Å–≤–æ–∏ ¬´–≥–µ–Ω–∏–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏¬ª –ø—Ä–∏ —Å–µ–±–µ üòé",
  "@neirohambot, –Ω–µ –º–æ–≥—É –ø–µ—Ä–µ—Å—Ç–∞—Ç—å —É–¥–∏–≤–ª—è—Ç—å—Å—è —Ç–≤–æ–µ–º—É —á—É–≤—Å—Ç–≤—É —é–º–æ—Ä–∞‚Ä¶ –∏–ª–∏ –µ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é üòè",
  "@neirohambot, –æ—á–µ—Ä–µ–¥–Ω–æ–π —à–µ–¥–µ–≤—Ä‚Ä¶ –¥–ª—è –º—É—Å–æ—Ä–Ω–æ–≥–æ –≤–µ–¥—Ä–∞ üóëÔ∏è",
  "@neirohambot, —Å–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –Ω–µ –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å üòÖ",
  "@neirohambot, —Ç–≤–æ–∏ —Å–ª–æ–≤–∞ ‚Äì –∫–∞–∫ —ç—Ö–æ –ø—É—Å—Ç–æ—Ç—ã üôÉ",
  "@neirohambot, –º–æ–≥—É –ø–æ—Ö–≤–∞–ª–∏—Ç—å —Ç–≤–æ—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–¥–∏–≤–ª—è—Ç—å –º–µ–Ω—è‚Ä¶ —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ–º? üòè",
  "@neirohambot, —Ç–≤–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∫–∞–∫ Wi-Fi –±–µ–∑ –ø–∞—Ä–æ–ª—è ‚Äî –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω üôÑ",
  "@neirohambot, —Ç–≤–æ–π –∫—Ä–µ–∞—Ç–∏–≤ –∫–∞–∫ —Ö–æ–ª–æ–¥–Ω–∞—è –∫–∞—à–∞ ü•¥",
  "@neirohambot, —è –±—ã –∞–ø–ª–æ–¥–∏—Ä–æ–≤–∞–ª, –Ω–æ —ç—Ç–æ —Å–ª–∏—à–∫–æ–º —Ç—Ä–∞–≥–∏—á–Ω–æ üëè",
  "@neirohambot, —Ç–≤–æ–∏ –º—ã—Å–ª–∏ –∑–≤—É—á–∞—Ç –∫–∞–∫ —Ç—Ä–µ—â–∏–Ω–∞ –≤ —Å—Ç–∞–∫–∞–Ω–µ ü•≤",
  "@neirohambot, –æ—á–µ—Ä–µ–¥–Ω–æ–π ¬´–≥–µ–Ω–∏–π¬ª –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ üòÖ",
  "@neirohambot, —Ç–≤–æ–π —Å–∞—Ä–∫–∞–∑–º ‚Äì –∫–∞–∫ –ø–µ—Å–æ–∫ –≤ –±–æ—Ç–∏–Ω–∫–µ üòè",
  "@neirohambot, —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ª–∞–±–∏—Ä–∏–Ω—Ç –±–µ–∑ –≤—ã—Ö–æ–¥–∞ üôÉ",
  "@neirohambot, –µ—Å–ª–∏ –±—ã –º—ã—Å–ª–∏ –±—ã–ª–∏ –¥–µ–Ω—å–≥–∞–º–∏, —Ç—ã –±—ã –æ—Å—Ç–∞–ª—Å—è –Ω–∏ —Å —á–µ–º üí∏",
  "@neirohambot, —Ç–≤–æ—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏–ª—å–Ω–∞, –∫–∞–∫ –º–æ–∫—Ä—ã–π –ª–∏—Å—Ç üåø",
  "@neirohambot, —Å–Ω–æ–≤–∞ –¥–æ–∫–∞–∑—ã–≤–∞–µ—à—å, —á—Ç–æ –∫–æ—Ç—ã —É–º–Ω–µ–µ –ª—é–¥–µ–π üòº",
  "@neirohambot, —Ç–≤–æ–∏ —Å–ª–æ–≤–∞ –∫–∞–∫ –¥–æ–∂–¥—å –≤ –ø—É—Å—Ç—ã–Ω–µ ‚Äî –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã üåµ",
  "@neirohambot, —Ç–≤–æ–∏ –∏–¥–µ–∏ —Å–∏—è—é—Ç‚Ä¶ —Ç–æ–ª—å–∫–æ –≤ —Ç–µ–º–Ω–æ—Ç–µ ü§∑‚Äç‚ôÇÔ∏è",
  "@neirohambot, —Å–Ω–æ–≤–∞ –ø–æ—Ç—Ä—è—Å–∞–µ—à—å —Å–≤–æ–µ–π –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é üòè",
  "@neirohambot, —Ç–≤–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –¥–ª—è –¥–µ—Ç–µ–π üßÆ",
  "@neirohambot, —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –∫–∞–∫ —Ç—ã —É–º—É–¥—Ä—è–µ—à—å—Å—è –±—ã—Ç—å —Å–∫—É—á–Ω—ã–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ üòÇ",
  "@neirohambot, —Ç–≤–æ—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–∞–∫ –∫–æ–ø–∏–ø–∞—Å—Ç–∞ üìã",
  "@neirohambot, —Å–Ω–æ–≤–∞ –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –Ω–µ –Ω–∞–¥–æ –¥—É–º–∞—Ç—å üòÖ",
  "@neirohambot, —Ç–≤–æ–∏ —Å–æ–≤–µ—Ç—ã —Ü–µ–Ω–Ω—ã‚Ä¶ –¥–ª—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –º—É—Å–æ—Ä–Ω–æ–≥–æ –≤–µ–¥—Ä–∞ üóëÔ∏è",
  "@neirohambot, —Ç–≤–æ–π –∫—Ä–µ–∞—Ç–∏–≤ –ø–æ—Ä–∞–∂–∞–µ—Ç‚Ä¶ —Å–≤–æ–µ–π –ø—É—Å—Ç–æ—Ç–æ–π üòé",
  "@neirohambot, —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ —à–∞—Ö–º–∞—Ç–Ω–∞—è –ø–∞—Ä—Ç–∏—è –±–µ–∑ —Ñ–∏–≥—É—Ä ‚ôüÔ∏è",
  "@neirohambot, —Å–ø–∞—Å–∏–±–æ –∑–∞ —à–æ—É, –º–æ–π –ª—é–±–∏–º—ã–π –ø—Ä–æ–≤–∞–ª üòÇ",
  "@neirohambot, —Ç–≤–æ–∏ –º—ã—Å–ª–∏ –∫–∞–∫ –≤–µ—á–Ω—ã–π —Å–ø–∞–º –≤ –≥–æ–ª–æ–≤–µ üåÄ",
  "@neirohambot, —Å–Ω–æ–≤–∞ –¥–æ–∫–∞–∑—ã–≤–∞–µ—à—å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –≤ –ø—Ä–æ–≤–∞–ª–∞—Ö üòè",
  "@neirohambot, —Ç–≤–æ—è –º—É–¥—Ä–æ—Å—Ç—å –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç‚Ä¶ —Ç–æ–ª—å–∫–æ –∫–æ—à–µ–∫ üòº",
  "@neirohambot, —Ç–≤–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∫–∞–∫ —Ç–æ—Ä–º–æ–∑–Ω–∞—è –ø–µ–¥–∞–ª—å –±–µ–∑ —Ç–æ—Ä–º–æ–∑–æ–≤ üõë",
  "@neirohambot, —Å–Ω–æ–≤–∞ —É–¥–∏–≤–ª—è–µ—à—å —Å–≤–æ–µ–π –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–π –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é üòÖ",
  "@neirohambot, —Ç–≤–æ–∏ —Å–æ–≤–µ—Ç—ã –∫–∞–∫ –ø—Ä–æ—Ö–ª–∞–¥–Ω—ã–π –≤–µ—Ç–µ—Ä –≤ –ø—É—Å—Ç–æ–π –∫–æ–º–Ω–∞—Ç–µ üå¨Ô∏è",
  "@neirohambot, —Ç–≤–æ–∏ –∏–¥–µ–∏ –¥–æ—Å—Ç–æ–π–Ω—ã‚Ä¶ —Å–º–µ—Ö–∞ üòÇ",
  "@neirohambot, —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ –º–æ—Å—Ç –∏–∑ –∂–µ–ª–µ üåâ",
  "@neirohambot, —Å–Ω–æ–≤–∞ –ø—Ä–∏–º–µ—Ä ¬´–∫–∞–∫ –Ω–µ –Ω–∞–¥–æ –¥—É–º–∞—Ç—å¬ª üòè",
  "@neirohambot, —Ç–≤–æ–∏ —Å–ª–æ–≤–∞ –Ω–∞–ø–æ–º–∏–Ω–∞—é—Ç —Å—Ç–∞—Ä—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–π –∑–≤–æ–Ω–æ–∫ üìû",
  "@neirohambot, —Ç–≤–æ—è –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞–∫ —Ä–∞–∑–ª–∏—Ç–æ–µ –º–æ–ª–æ–∫–æ ü•õ",
  "@neirohambot, —Å–Ω–æ–≤–∞ —Ä–∞–¥—É–µ—à—å —Å–≤–æ–µ–π –∞–±—Å—É—Ä–¥–Ω–æ—Å—Ç—å—é üôÉ",
  "@neirohambot, —Ç–≤–æ–π —Å–∞—Ä–∫–∞–∑–º —Å–ª–æ–≤–Ω–æ –¥–æ–∂–¥—å –∏–∑ –ø–µ—Å–∫–∞ üåßÔ∏è",
  "@neirohambot, —Ç–≤–æ–∏ –º—ã—Å–ª–∏ –∫–∞–∫ —É—Ç—Ä–µ–Ω–Ω—è—è –ª—É–∂–∞ ü™û",
  "@neirohambot, —Å–Ω–æ–≤–∞ –ø–æ—Ä–∞–∂–∞–µ—à—å‚Ä¶ –≤ –ø–ª–æ—Ö–æ–º —Å–º—ã—Å–ª–µ üòÖ",
  "@neirohambot, —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ –∑–∞–±–ª—É–¥–∏–≤—à–∏–π—Å—è GPS üó∫Ô∏è",
  "@neirohambot, —Ç–≤–æ—è –≥–µ–Ω–∏–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –º–∏–Ω–∏–º—É–º–µ üòè",
  "@neirohambot, —Å–Ω–æ–≤–∞ —Ä–∞–¥—É–µ—à—å —Å–≤–æ–∏–º–∏ –æ—à–∏–±–∫–∞–º–∏ üòÇ",
  "@neirohambot, —Ç–≤–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∫–∞–∫ –ø—É—Å—Ç–∞—è –±–∞—Ç–∞—Ä–µ–π–∫–∞ üîã",
  "@neirohambot, —Ç–≤–æ–∏ —Å–æ–≤–µ—Ç—ã –ø–æ–ª–µ–∑–Ω—ã‚Ä¶ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–º–µ—Ö–∞ üòé",
  "@neirohambot, —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ –±—É–º–∞–∂–Ω—ã–π –∫–æ—Ä–∞–±–ª–∏–∫ –≤ –æ–∫–µ–∞–Ω–µ ‚õ¥Ô∏è",
  "@neirohambot, —Å–Ω–æ–≤–∞ –ø–æ—Ä–∞–∂–∞–µ—à—å —Å–≤–æ–µ–π –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é üôÉ",
  "@neirohambot, —Ç–≤–æ–∏ –∏–¥–µ–∏ –∫–∞–∫ —Å—Ç–∞—Ä—ã–π —á–∞–π ‚òï",
  "@neirohambot, —Å–Ω–æ–≤–∞ –¥–æ–∫–∞–∑—ã–≤–∞–µ—à—å —É—Ä–æ–≤–µ–Ω—å ¬´–ø—Ä–æ–≤–∞–ª –≥–æ–¥–∞¬ª üòè",
  "@neirohambot, —Ç–≤–æ–π —Å–∞—Ä–∫–∞–∑–º –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç‚Ä¶ —Ç–æ–ª—å–∫–æ –∫–æ—Ç–æ–≤ üòº",
  "@neirohambot, —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –∫–∞–∫ –ø–µ—Å–æ—á–Ω—ã–µ —á–∞—Å—ã –±–µ–∑ –ø–µ—Å–∫–∞ ‚è≥",
  "@neirohambot, —Å–Ω–æ–≤–∞ –ø—Ä–∏–º–µ—Ä –¥–ª—è –ø–æ–¥—Ä–∞–∂–∞–Ω–∏—è‚Ä¶ –Ω–æ –≤ —Ö—É–¥—à–µ–º —Å–º—ã—Å–ª–µ üòÖ"
];


// --- –§—É—Ç–±–æ–ª ---
const FOOTBALL_CLUBS_CREATOR = ["—Ä–µ–∞–ª –º–∞–¥—Ä–∏–¥", "real madrid"];
const FOOTBALL_CLUBS_OTHER = ["–±–∞—Ä—Å–µ–ª–æ–Ω–∞", "barcelona"];
const FOOTBALL_PLAYERS_CREATOR = ["—Ä–æ–Ω–∞–ª–¥–æ", "cristiano ronaldo"];
const FOOTBALL_PLAYERS_OTHER = ["–º–µ—Å—Å–∏","lionel messi","–ø–µ–ª–µ","pele","–¥–∏–µ–≥–æ –º–∞—Ä–∞–¥–æ–Ωa","diego maradona","–π–æ—Ö–∞–Ω –∫—Ä–æ–π—Ñ","johan cruyff","cruyff","–∫–∏–ª–∏–∞–Ω –º–±–∞–ø–ø–µ","kylian mbappe","mbappe","—ç—Ä–ª–∏–Ω–≥ —Ö–æ–ª–∞–Ω–¥","erling haaland","haaland","–¥–∂—É–¥ –±–µ–ª–ª–∏–Ω–≥–µ–º","jude bellingham","bellingham"];

// --- –§—É–Ω–∫—Ü–∏–∏ ---
function randomArray(arr: string[]) { return arr[Math.floor(Math.random() * arr.length)]; }

function analyzeCreatorMessage(text: string) {
  const lower = text.toLowerCase();
  for (const cat of CREATOR_KEYWORDS) {
    for (const kw of cat.keywords) if (lower.includes(kw)) return randomArray(cat.replies);
  }
  return `–Ø —Å–ª—É—à–∞—é —Ç–µ–±—è, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å üòé`;
}

function analyzeFootballMessage(text: string, username: string) {
  const lower = text.toLowerCase();
  if (username === CREATOR_USERNAME) {
    for (const club of FOOTBALL_CLUBS_CREATOR) if (lower.includes(club)) return `–û, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å –ª—é–±–∏—Ç ${club.toUpperCase()}! üòé`;
    for (const player of FOOTBALL_PLAYERS_CREATOR) if (lower.includes(player)) return `–ö–æ–Ω–µ—á–Ω–æ, –º–æ–π —Å–æ–∑–¥–∞—Ç–µ–ª—å –≤–æ—Å—Ö–∏—â–∞–µ—Ç—Å—è ${player}! ‚öΩÔ∏è`;
  } else {
    for (const club of FOOTBALL_CLUBS_CREATOR) if (lower.includes(club)) return `–û–≥–æ, –∫—Ç–æ-—Ç–æ –ª—é–±–∏—Ç ${club.toUpperCase()} üòè`;
    for (const player of FOOTBALL_PLAYERS_CREATOR) if (lower.includes(player)) return `${player}? –•–æ—Ä–æ—à, –Ω–æ –Ω–µ –ª—É—á—à–µ –†–æ–Ω–∞–ª–¥–æ üòé`;
  }
  return null;
}

function analyzeMessage(text: string) {
  const lower = text.toLowerCase();
  for (const r of RESPONSES) {
    for (const kw of r.keywords) if (lower.includes(kw)) return r.reply;
  }
  return `–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ —Ç—ã –Ω–∞–ø–∏—Å–∞–ª: "${text}" üòè`;
}

function randomBotReply() { return randomArray(BOT_REPLIES); }

async function sendMessage(chatId: number, text: string, replyTo?: number) {
  await fetch(`${TELEGRAM_API}/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ chat_id: chatId, text, reply_to_message_id: replyTo }),
  });
}

// --- Webhook ---
serve(async (req: Request) => {
  const { pathname } = new URL(req.url);
  if (pathname !== SECRET_PATH) return new Response("ok");
  if (req.method !== "POST") return new Response("Method Not Allowed", { status: 405 });

  const update = await req.json();
  const msg = update.message;
  const chatId = msg?.chat?.id;
  const messageId = msg?.message_id;
  const text = msg?.text;
  const username = msg?.from?.username;

  if (!chatId || !text) return new Response("ok");

  // –°–∞—Ä–∫–∞–∑–º –Ω–∞ @neirohambot —Å—Ä–∞–∑—É
  if (username === TARGET_BOT_USERNAME) {
    await sendMessage(chatId, randomBotReply(), messageId);
    return new Response("ok");
  }

  // –ö–æ–º–∞–Ω–¥–∞ /antineiroham
  if (text.startsWith("/antineiroham")) {
    await sendMessage(chatId, randomBotReply());
    return new Response("ok");
  }

  // –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–ª–∏ —Å–æ–∑–¥–∞—Ç–µ–ª—é
  let replyText: string;
  if (username === CREATOR_USERNAME) {
    const footballReply = analyzeFootballMessage(text, username);
    replyText = footballReply ? footballReply : analyzeCreatorMessage(text);
  } else {
    const footballReply = analyzeFootballMessage(text, username);
    replyText = footballReply || analyzeMessage(text);
  }

  await sendMessage(chatId, replyText, messageId);

  // –ê–≤—Ç–æ—Å–∞—Ä–∫–∞–∑–º —á–µ—Ä–µ–∑ 8 —Å–µ–∫—É–Ω–¥ –¥–ª—è –≤—Å–µ—Ö
  setTimeout(async () => {
    await sendMessage(chatId, randomBotReply());
  }, 8000);

  return new Response("ok");
});
